<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parameters · SpectralFitting.jl</title><meta name="title" content="Parameters · SpectralFitting.jl"/><meta property="og:title" content="Parameters · SpectralFitting.jl"/><meta property="twitter:title" content="Parameters · SpectralFitting.jl"/><meta name="description" content="Documentation for SpectralFitting.jl."/><meta property="og:description" content="Documentation for SpectralFitting.jl."/><meta property="twitter:description" content="Documentation for SpectralFitting.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="SpectralFitting.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpectralFitting.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../walkthrough/">Walkthrough</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/examples/">Diverse examples</a></li><li><a class="tocitem" href="../examples/sherpa-example/">A quick guide</a></li></ul></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../models/using-models/">Using models</a></li><li><a class="tocitem" href="../models/models/">Model index</a></li><li><a class="tocitem" href="../models/composite-models/">Composite models</a></li><li><a class="tocitem" href="../models/surrogate-models/">Surrogate models</a></li><li><a class="tocitem" href="../models/xspec-models/">XSPEC models</a></li></ul></li><li><span class="tocitem">Fitting</span><ul><li class="is-active"><a class="tocitem" href>Parameters</a><ul class="internal"><li><a class="tocitem" href="#Parameter-binding"><span>Parameter binding</span></a></li></ul></li></ul></li><li><span class="tocitem">Datasets</span><ul><li><a class="tocitem" href="../datasets/datasets/">Using datasets</a></li><li><a class="tocitem" href="../datasets/mission-support/">Mission support</a></li></ul></li><li><a class="tocitem" href="../why-and-how/">Why &amp; How</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Fitting</a></li><li class="is-active"><a href>Parameters</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Parameters</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/fjebaker/SpectralFitting.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/fjebaker/SpectralFitting.jl/blob/main/docs/src/parameters.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h1><h2 id="Parameter-binding"><a class="docs-heading-anchor" href="#Parameter-binding">Parameter binding</a><a id="Parameter-binding-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-binding" title="Permalink"></a></h2><p>When performing a fit, it is desireable to <strong>bind</strong> certain parameters together. This ensures that they will have the same value; for example, if you were fitting two simultaneous datasets with two <a href="../models/models/#SpectralFitting.PowerLaw"><code>PowerLaw</code></a> models, you may want to have different normalisations of the model components, but enforce the power law index to be the same. To achieve this, SpectralFitting has the <a href="#SpectralFitting.bind!"><code>bind!</code></a> function that applies to your <a href="@ref"><code>FittingProblem</code></a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralFitting.bind!" href="#SpectralFitting.bind!"><code>SpectralFitting.bind!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bind!(prob::FittingProblem, pairs::Pair{Int,Symbol}...)
bind!(prob::FittingProblem, symbols::Symbol...)</code></pre><p>Bind parameters together within a <a href="@ref"><code>FittingProblem</code></a>. Parameters bound together will be mandated to have exact same value during the fit.</p><p>The binding may either be a single symbol that is present in all models in the fitting problem, or a series of pairs <code>Int =&gt; Symbol</code> which index the specific model and parameters to bind together. All bindings specified in a single call to <code>bind!</code> will be bound together. Multiple bindings are possible with repeated call to <code>bind!</code>.</p><ul><li>Bind model 1&#39;s <code>K_1</code> parameter to model 2&#39;s <code>K_3</code>:</li></ul><pre><code class="language-julia hljs">bind!(prob, 1 =&gt; :K_1, 2 =&gt; :K_3)</code></pre><ul><li>Bind model 3&#39;s <code>K_2</code> parameter to model4&#39;s <code>:L_1</code> and model 6&#39;s <code>a_3</code>:</li></ul><pre><code class="language-julia hljs">bind!(prob, 3 =&gt; :K_2, 4 =&gt; :L_1, 6 =&gt; :a_3)</code></pre><ul><li>Bind the <code>K_1</code> parameter across all the models:</li></ul><pre><code class="language-julia hljs">bind!(prob, :K_1)</code></pre><p><strong>Examples</strong></p><p>Consider the following two models</p><pre><code class="language-julia hljs">model1 = PhotoelectricAbsorption() * (BlackBody() + PowerLaw())
model2 = PhotoelectricAbsorption() * (PowerLaw() + PowerLaw())

prob = FittingProblem(model1 =&gt; data1, model2 =&gt; data2)

# bind the power law indices in the two models
bind!(prob, :a_1)

# bind the normalisation of powerlaws in the 2nd model:
bind!(prob, 2 =&gt; :K_1, 2 =&gt; :K_2)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Only free parameters can be bound together.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/62aceba26480c39cf5d90b8beb909a572d786085/src/fitting/binding.jl#L73-L122">source</a></section></article><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Bindings are treated not as specific to the model but specific to the <a href="@ref"><code>FittingProblem</code></a>. This is because you may want to use the same model for multiple different datasets, and have slightly different binding requirements for each one (e.g. depending on the instruments you are using). If you do need the same binding applied to two different problems, you can do that with</p><pre><code class="language-julia hljs">append!(prob1.bindings, prob2.bindings)</code></pre><p>Caution however, this will only make sense if you are using precisely the same model in both problems.</p></div></div><p>Let&#39;s try it out. We&#39;ll generate some arbitrary powerlaw spectra with different normalisations and fit them simultaneously.</p><pre><code class="language-julia hljs">using SpectralFitting, Plots

energy = collect(range(0.1, 10.0, 100))

# two different models with different normalisations
model1 = PowerLaw(K = FitParam(100.0), a = FitParam(1.2))
model2 = PowerLaw(K = FitParam(300.0), a = FitParam(1.22))

data1 = simulate(energy, model1, var = 1e-3)
data2 = simulate(energy, model2, var = 1e-3)

plot(data1, xscale = :log10, yscale = :log10)
plot!(data2, xscale = :log10, yscale = :log10)</code></pre><img src="74f1c3c1.svg" alt="Example block output"/><p>Now we want to fit a single powerlaw model to both of these spectra simultaneously, but with the powerlaw index fixed to be the same in both models.</p><pre><code class="language-julia hljs">model = PowerLaw()
prob = FittingProblem(model =&gt; data1, model =&gt; data2)

bind!(prob, :a)
prob</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌ FittingProblem:
│   . Models     : 2
│   . Datasets   : 2
│   Parameter Summary:
│   . Total      : 4
│   . <span class="sgr36">Frozen</span>     : 0
│   . <span class="sgr36">Bound</span>      : 1
│   . <span class="sgr36">Free</span>       : 3
└ </code></pre><p>We can get a better look at our model configuration by using the <a href="@ref"><code>details</code></a> method:</p><pre><code class="language-julia hljs">details(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌ Models:
│   <span class="sgr33">Model 1</span>: PowerLaw
│        K -&gt;  1 ± 0.1  ∈ [ 0, Inf ]<span class="sgr32">   FREE</span>
│        a -&gt;  2 ± 0.2  ∈ [ 0, Inf ]<span class="sgr32">   FREE</span>
│
│   <span class="sgr33">Model 2</span>: PowerLaw
│        K -&gt;  1 ± 0.1  ∈ [ 0, Inf ]<span class="sgr32">   FREE</span>
│        a -&gt;  2 ± 0.2  ∈ [ 0, Inf ]   <span class="sgr35">~Model 1 a</span>
└</code></pre><p>In this printout we see that the <code>a</code> parameter of <code>Model 2</code> is bound to the <code>a</code> parameter of <code>Model 1</code>.</p><pre><code class="language-julia hljs">result = fit(prob, LevenbergMarquadt())

plot(data1, xscale = :log10, yscale = :log10)
plot!(data2, xscale = :log10, yscale = :log10)
plot!(result[1])
plot!(result[2])</code></pre><img src="a648edbd.svg" alt="Example block output"/><p>Note that these fits are not perfect, because the underlying data have subtly different power law indices, but our fit is required to enforce the models to have the same value. If we release this requirement, the fit will be better, but the models will be entirely independent.</p><pre><code class="language-julia hljs">prob = FittingProblem(model =&gt; data1, model =&gt; data2)

result = SpectralFitting.fit(prob, LevenbergMarquadt())

plot(data1, xscale = :log10, yscale = :log10)
plot!(data2, xscale = :log10, yscale = :log10)
plot!(result[1])
plot!(result[2])</code></pre><img src="8e6cfd72.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../models/xspec-models/">« XSPEC models</a><a class="docs-footer-nextpage" href="../datasets/datasets/">Using datasets »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Thursday 27 February 2025 12:22">Thursday 27 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
