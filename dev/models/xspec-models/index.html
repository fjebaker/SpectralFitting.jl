<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>XSPEC models · SpectralFitting.jl</title><meta name="title" content="XSPEC models · SpectralFitting.jl"/><meta property="og:title" content="XSPEC models · SpectralFitting.jl"/><meta property="twitter:title" content="XSPEC models · SpectralFitting.jl"/><meta name="description" content="Documentation for SpectralFitting.jl."/><meta property="og:description" content="Documentation for SpectralFitting.jl."/><meta property="twitter:description" content="Documentation for SpectralFitting.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="SpectralFitting.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SpectralFitting.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../walkthrough/">Walkthrough</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/examples/">Diverse examples</a></li><li><a class="tocitem" href="../../examples/sherpa-example/">A quick guide</a></li></ul></li><li><span class="tocitem">Fitting</span><ul><li><a class="tocitem" href="../../parameters/">Parameters</a></li></ul></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../using-models/">Using models</a></li><li><a class="tocitem" href="../models/">Model index</a></li><li><a class="tocitem" href="../composite-models/">Composite models</a></li><li><a class="tocitem" href="../wrapper-models/">Wrapper models</a></li><li><a class="tocitem" href="../surrogate-models/">Surrogate models</a></li><li class="is-active"><a class="tocitem" href>XSPEC models</a><ul class="internal"><li><a class="tocitem" href="#Additive"><span>Additive</span></a></li></ul></li></ul></li><li><span class="tocitem">Datasets</span><ul><li><a class="tocitem" href="../../datasets/datasets/">Using datasets</a></li><li><a class="tocitem" href="../../datasets/mission-support/">Mission support</a></li></ul></li><li><a class="tocitem" href="../../why-and-how/">Why &amp; How</a></li><li><a class="tocitem" href="../../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Models</a></li><li class="is-active"><a href>XSPEC models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>XSPEC models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/fjebaker/SpectralFitting.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/fjebaker/SpectralFitting.jl/blob/main/docs/src/models/xspec-models.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="XSPEC-models"><a class="docs-heading-anchor" href="#XSPEC-models">XSPEC models</a><a id="XSPEC-models-1"></a><a class="docs-heading-anchor-permalink" href="#XSPEC-models" title="Permalink"></a></h1><p>SpectralFitting can vendor the XSPEC model library through the utility package XSPECModels.jl. You can install this package directly from the University of Bristol&#39;s <a href="https://github.com/astro-group-bristol/AstroRegistry">AstroRegistry</a>:</p><pre><code class="language-julia hljs">pkg&gt; registry add https://github.com/astro-group-bristol/AstroRegistry
pkg&gt; add XSPECModels</code></pre><p>Using the package is straight forward once installed:</p><pre><code class="language-julia hljs">using SpectralFitting, XSPECModels</code></pre><div class="admonition is-info" id="Note-ff0d05696660befe"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-ff0d05696660befe" title="Permalink"></a></header><div class="admonition-body"><p>The convention is that models that have are imported from XSPEC or have XSPEC ABI are prefixed with <code>XS_</code> in their name. For example, the XSPEC equivalent of <a href="../models/#SpectralFitting.PowerLaw"><code>PowerLaw</code></a> is <a href="#XSPECModels.XS_PowerLaw"><code>XS_PowerLaw</code></a>.</p></div></div><p>The XSPEC models are wrapped into SpectralFitting models using the [<code>@xspecmodel</code>] macro. If a model you require is not already wrapped, this macro will make that easy to do. Please consider upstreaming your wrapper via a PR to the SpectralFitting GitHub repository.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="XSPECModels.@xspecmodel" href="#XSPECModels.@xspecmodel"><code>XSPECModels.@xspecmodel</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@xspecmodel [type=Float64] [ff_call_site] model</code></pre><p>Used to wrap additional XSPEC models, generating the needed <a href="../using-models/#SpectralFitting.AbstractSpectralModel"><code>AbstractSpectralModel</code></a> implementation.</p><p>The <code>type</code> keyword specifies the underlying type to coerce input and output arrays to, as different implementations may have incompatible number of bits. The <code>ff_call_site</code> is the foreign fuction call site, which is the first argument to <code>ccall</code>, and follows the same conventions. The <code>model</code> is a struct, which must subtype <a href="../using-models/#SpectralFitting.AbstractSpectralModel"><code>AbstractSpectralModel</code></a>.</p><p>If the callsite is not specified, the user must implement <a href="@ref"><code>_unsafe_ffi_invoke!</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">@xspecmodel :C_powerlaw struct XS_PowerLaw{T} &lt;: AbstractSpectralModel{T, Additive}
    &quot;Normalisation.&quot;
    K::T
    &quot;Photon index.&quot;
    a::T
end

# constructor has default values
function XS_PowerLaw(; K = FitParam(1.0), a = FitParam(1.0))
    XS_PowerLaw{typeof(K)}(K, a)
end</code></pre><p>We define a new structure <code>XS_PowerLaw</code> with two parameters, but since the model is <a href="../using-models/#SpectralFitting.Additive"><code>Additive</code></a>, only a single parameter (<code>a</code>) is passed to the XSPEC function. The function we bind to this model is <code>:C_powerlaw</code> from the XSPEC C wrappers.</p><p>The macro will then generate the following functions</p><ul><li><a href="../using-models/#SpectralFitting.implementation"><code>implementation</code></a></li><li><a href="@ref"><code>invoke!</code></a></li><li><a href="@ref"><code>_safe_ffi_invoke!</code></a></li></ul><p>If a callsite was specified, it will also generate:</p><ul><li><a href="@ref"><code>_unsafe_ffi_invoke!</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/fe119b4f9d7c74c9e57567f1f46f13f32a3db575/lib/XSPECModels/src/ccall-wrapper.jl#L126-L166">source</a></section></article><p>XSPEC models frequently have tabular data dependencies, without which the models fail to invoke (see <a href="../using-models/#Model-data-availability">Model data availability</a>). If the data files are known but not present, the XSPEC models will throw an error with instructions for downloading the missing data. If the data files are unknown, Julia may crash catastrophically. If this is the case, often a single line will be printed with the LibXSPEC error, specifying the name of the missing source file. This can be registered as a data dependency of a model using <a href="../models/#SpectralFitting.register_model_data"><code>SpectralFitting.register_model_data</code></a>.</p><p>The first time any XSPEC model is invoked, SpectralFitting checks to see whether requisite data is needed, and whether the data is downloaded. Subsequent calls will hit a lookup cache instead to avoid run-time costs of performing this check.</p><h2 id="Additive"><a class="docs-heading-anchor" href="#Additive">Additive</a><a id="Additive-1"></a><a class="docs-heading-anchor-permalink" href="#Additive" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="XSPECModels.XS_PowerLaw" href="#XSPECModels.XS_PowerLaw"><code>XSPECModels.XS_PowerLaw</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">XS_PowerLaw(K, a)</code></pre><ul><li><p><code>K</code>: Normalisation.</p></li><li><p><code>a</code>: Photon index.</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(0.1, 20.0, 100))
invokemodel(energy, XS_PowerLaw())</code></pre><pre><code class="nohighlight hljs">                      XS_PowerLaw
       ┌────────────────────────────────────────┐
   0.5 │                                        │
       │:                                       │
       │:                                       │
       │:                                       │
       │:                                       │
       │:                                       │
       │:                                       │
       │ :                                      │
       │ :                                      │
       │  :                                     │
       │   :.                                   │
       │    &#39;:..                                │
       │        &#39;&#39;&#39;:......                      │
       │                  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;........│
     0 │                                        │
       └────────────────────────────────────────┘
        0                                     20
                         E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/fe119b4f9d7c74c9e57567f1f46f13f32a3db575/lib/XSPECModels/src/additive.jl#L1-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="XSPECModels.XS_BlackBody" href="#XSPECModels.XS_BlackBody"><code>XSPECModels.XS_BlackBody</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">XS_BlackBody(K, T)</code></pre><ul><li><p><code>K</code>: Normalisation.</p></li><li><p><code>T</code>: Temperature (keV).</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(0.1, 20.0, 100))
invokemodel(energy, XS_BlackBody())</code></pre><pre><code class="nohighlight hljs">                      XS_BlackBody
       ┌────────────────────────────────────────┐
   0.2 │                                        │
       │                                        │
       │                                        │
       │                                        │
       │                                        │
       │                                        │
       │      .:&#39;&#39;&#39;:..                          │
       │    .:       &#39;&#39;.                        │
       │   .&#39;           &#39;:.                     │
       │   :              &#39;&#39;..                  │
       │  :                  &#39;:.                │
       │ :                     &#39;&#39;:.             │
       │.:                         &#39;&#39;..         │
       │:                              &#39;&#39;:....  │
     0 │&#39;                                    &#39;&#39;&#39;│
       └────────────────────────────────────────┘
        0                                     20
                         E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/fe119b4f9d7c74c9e57567f1f46f13f32a3db575/lib/XSPECModels/src/additive.jl#L103-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="XSPECModels.XS_BremsStrahlung" href="#XSPECModels.XS_BremsStrahlung"><code>XSPECModels.XS_BremsStrahlung</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">XS_BremsStrahlung(K, T)</code></pre><ul><li><p><code>K</code>: Normalisation.</p></li><li><p><code>T</code>: Plasma temperature (keV).</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(0.1, 20.0, 100))
invokemodel(energy, XS_BremsStrahlung())</code></pre><pre><code class="nohighlight hljs">                  XS_BremsStrahlung
     ┌────────────────────────────────────────┐
   2 │                                        │
     │.                                       │
     │:                                       │
     │:                                       │
     │:                                       │
     │:                                       │
     │:                                       │
     │:                                       │
     │:                                       │
     │:                                       │
     │:                                       │
     │:                                       │
     │&#39;.                                      │
     │ :                                      │
   0 │  &#39;:....................................│
     └────────────────────────────────────────┘
      0                                     20
                       E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/fe119b4f9d7c74c9e57567f1f46f13f32a3db575/lib/XSPECModels/src/additive.jl#L148-L182">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="XSPECModels.XS_Gaussian" href="#XSPECModels.XS_Gaussian"><code>XSPECModels.XS_Gaussian</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">XS_Gaussian(K, E, σ)</code></pre><ul><li><p><code>K</code>: Normalisation</p></li><li><p><code>E</code>: Line energy in keV.</p></li><li><p><code>σ</code>: Line width in keV.</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(4.0, 8.0, 100))
invokemodel(energy, XS_Gaussian())</code></pre><pre><code class="nohighlight hljs">                        XS_Gaussian
        ┌────────────────────────────────────────┐
   0.09 │                                        │
        │            .                           │
        │           : :                          │
        │           : :                          │
        │           : &#39;.                         │
        │          .&#39;  :                         │
        │          :   :                         │
        │          :   :                         │
        │          :   &#39;.                        │
        │         :     :                        │
        │         :     :                        │
        │         :     :                        │
        │        .&#39;      :                       │
        │        :       :                       │
      0 │.......:         :......................│
        └────────────────────────────────────────┘
         0                                     20
                          E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/fe119b4f9d7c74c9e57567f1f46f13f32a3db575/lib/XSPECModels/src/additive.jl#L464-L498">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="XSPECModels.XS_Laor" href="#XSPECModels.XS_Laor"><code>XSPECModels.XS_Laor</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">XS_Laor(K, lineE, a, inner_r, outer_r, incl)</code></pre><ul><li><p><code>K</code>: Normalisation.</p></li><li><p><code>lineE</code>: Rest frame line energy (keV).</p></li><li><p><code>a</code>: Power law dependence of emissivity. Scales R⁻ᵅ.</p></li><li><p><code>inner_r</code>: Inner radius of the accretion disk (GM/c).</p></li><li><p><code>outer_r</code>: Outer radius of the accretion disk (GM/c).</p></li><li><p><code>θ</code>: Disk inclination angle to line of sight (degrees, 0 is pole on).</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(0.1, 10.0, 100))
invokemodel(energy, XS_Laor())</code></pre><pre><code class="nohighlight hljs">                          XS_Laor
        ┌────────────────────────────────────────┐
   0.06 │                                        │
        │                                        │
        │                         ::             │
        │                         ::             │
        │                        : :             │
        │                       :  :             │
        │                      :   :             │
        │                     :&#39;   :             │
        │                   .:     :             │
        │                  :&#39;      :             │
        │                .&#39;        :             │
        │              .:&#39;         :             │
        │            ..&#39;           :             │
        │          .:&#39;              :            │
      0 │.......:&#39;&#39;                 :............│
        └────────────────────────────────────────┘
         0                                     10
                          E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/fe119b4f9d7c74c9e57567f1f46f13f32a3db575/lib/XSPECModels/src/additive.jl#L344-L378">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="XSPECModels.XS_DiskLine" href="#XSPECModels.XS_DiskLine"><code>XSPECModels.XS_DiskLine</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">XS_DiskLine(K, lineE, β, inner_r, outer_r, incl)</code></pre><ul><li><p><code>K</code>: Normalisation.</p></li><li><p><code>lineE</code>: Rest frame line energy (keV).</p></li><li><p><code>β</code>: Power law dependence of emissivity. If &lt; 10, scales Rᵅ.</p></li><li><p><code>inner_r</code>: Inner radius of the accretion disk (GM/c).</p></li><li><p><code>outer_r</code>: Outer radius of the accretion disk (GM/c).</p></li><li><p><code>θ</code>: Disk inclination angle to line of sight (degrees, 0 is pole on).</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(4.0, 8.0, 100))
invokemodel(energy, XS_DiskLine())</code></pre><pre><code class="nohighlight hljs">                        XS_DiskLine
        ┌────────────────────────────────────────┐
   0.09 │                                        │
        │                           .            │
        │                           :            │
        │                           ::           │
        │                         . ::           │
        │                         : ::           │
        │                         :&#39;&#39;:           │
        │                        .&#39;  :           │
        │                        :    :          │
        │                        :    :          │
        │                       .&#39;    :          │
        │                       :     :          │
        │                     .:      &#39;.         │
        │                   .:&#39;        :         │
      0 │...............:&#39;&#39;&#39;           :.........│
        └────────────────────────────────────────┘
         4                                      8
                          E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/fe119b4f9d7c74c9e57567f1f46f13f32a3db575/lib/XSPECModels/src/additive.jl#L404-L438">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="XSPECModels.XS_PhotoelectricAbsorption" href="#XSPECModels.XS_PhotoelectricAbsorption"><code>XSPECModels.XS_PhotoelectricAbsorption</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">XS_PhotoelectricAbsorption(ηH)</code></pre><ul><li><code>ηH</code>: Equivalent hydrogen column (units of 10²² atoms per cm⁻²).</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(0.1, 20.0, 100))
invokemodel(energy, XS_PhotoelectricAbsorption())</code></pre><pre><code class="nohighlight hljs">             XS_PhotoelectricAbsorption
     ┌────────────────────────────────────────┐
   1 │       ...&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;│
     │      .&#39;                                │
     │     :                                  │
     │    :&#39;                                  │
     │    :                                   │
     │   :                                    │
     │   :                                    │
     │   :                                    │
     │  :                                     │
     │  :                                     │
     │  :                                     │
     │  :                                     │
     │  :                                     │
     │ :                                      │
   0 │.:                                      │
     └────────────────────────────────────────┘
      0                                     20
                       E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/fe119b4f9d7c74c9e57567f1f46f13f32a3db575/lib/XSPECModels/src/multiplicative.jl#L1-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="XSPECModels.XS_WarmAbsorption" href="#XSPECModels.XS_WarmAbsorption"><code>XSPECModels.XS_WarmAbsorption</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">XS_WarmAbsorption(ηH, Ew)</code></pre><ul><li><p><code>ηH</code>: Equivalent hydrogen column (units of 10²² atoms per cm⁻²).</p></li><li><p><code>Ew</code>: Window energy (keV).</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(0.1, 20.0, 100))
invokemodel(energy, XS_WarmAbsorption())</code></pre><pre><code class="nohighlight hljs">                    XS_WarmAbsorption
       ┌────────────────────────────────────────┐
     1 │&#39;:      ...&#39;&#39;&#39;:&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;│
       │ :    .:&#39;                               │
       │ :   .&#39;                                 │
       │ :  .:                                  │
       │ :  :                                   │
       │ :  :                                   │
       │ : :                                    │
       │ : :                                    │
       │ : :                                    │
       │ : :                                    │
       │ ::                                     │
       │ ::                                     │
       │  :                                     │
       │  :                                     │
   0.2 │  :                                     │
       └────────────────────────────────────────┘
        0                                     20
                         E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/fe119b4f9d7c74c9e57567f1f46f13f32a3db575/lib/XSPECModels/src/multiplicative.jl#L45-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="XSPECModels.XS_CalculateFlux" href="#XSPECModels.XS_CalculateFlux"><code>XSPECModels.XS_CalculateFlux</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">XS_CalculateFlux(E_min, E_max, lg10Flux)</code></pre><ul><li><p><code>E_min</code>: Minimum energy.</p></li><li><p><code>E_max</code>: Maximum energy.</p></li><li><p><code>log10Flux</code>: log (base 10) flux in erg / cm^2 / s</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/fe119b4f9d7c74c9e57567f1f46f13f32a3db575/lib/XSPECModels/src/convolutional.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="XSPECModels.XS_KerrDisk" href="#XSPECModels.XS_KerrDisk"><code>XSPECModels.XS_KerrDisk</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">XS_KerrDisk(K, lineE, index1, index2, break_r, a, θ, inner_r, outer_r)</code></pre><ul><li><p><code>K</code>: Normalisation.</p></li><li><p><code>lineE</code>: Rest frame line energy (keV).</p></li><li><p><code>index1</code>: Emissivity index for inner disk.</p></li><li><p><code>index2</code>: Emissivity index for outer disk.</p></li><li><p><code>break_r</code>: Break radius separating inner and outer disk (gᵣ).</p></li><li><p><code>a</code>: Dimensionless black hole spin.</p></li><li><p><code>θ</code>: Disk inclination angle to line of sight (degrees).</p></li><li><p><code>inner_r</code>: Inner radius of the disk in units of rₘₛ.</p></li><li><p><code>outer_r</code>: Outer radius of the disk in units of rₘₛ.</p></li><li><p><code>z</code>: Redshift.</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(0.1, 20.0, 100))
invokemodel(energy, XS_KerrDisk())</code></pre><pre><code class="nohighlight hljs">                        XS_KerrDisk
        ┌────────────────────────────────────────┐
   0.05 │                                        │
        │                                        │
        │                                .       │
        │                               .:       │
        │                              :::       │
        │                            .:&#39; &#39;.      │
        │                           .:    :      │
        │                         ..&#39;     :      │
        │                         :&#39;      :      │
        │                       .&#39;        :      │
        │                     .:&#39;         :      │
        │                  .:&#39;&#39;           :      │
        │               .::&#39;              :      │
        │            ..:&#39;                 :      │
      0 │.........:&#39;&#39;&#39;                    :......│
        └────────────────────────────────────────┘
         0                                      8
                          E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/fe119b4f9d7c74c9e57567f1f46f13f32a3db575/lib/XSPECModels/src/additive.jl#L194-L228">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="XSPECModels.XS_KyrLine" href="#XSPECModels.XS_KyrLine"><code>XSPECModels.XS_KyrLine</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">XS_KyrLine(K, a, θ_obs, inner_r, ms_flag, outer_r, lineE, α, β, break_r, z, limb)</code></pre><ul><li><p><code>K</code>: Normalisation.</p></li><li><p><code>a</code>: Dimensionless black hole spin.</p></li><li><p><code>θ</code>: Observer inclination (0 is on pole, degrees).</p></li><li><p><code>inner_r</code>: Inner radius of the disk in units of GM/c²</p></li><li><p><code>ms_flag</code>: 0: integrate from rᵢₙ. 1: integrate from rₘₛ.</p></li><li><p><code>outer_r</code>: Outer radius of the disk in units of GM/c²</p></li><li><p><code>lineE</code>: Rest frame line energy (keV).</p></li><li><p><code>α</code></p></li><li><p><code>β</code></p></li><li><p><code>break_r</code>: Break radius seperating inner and outer disk (GM/c²).</p></li><li><p><code>z</code>: Overall Doppler shift.</p></li><li><p><code>limb</code>: 0: isotropic emission, 1: Laor&#39;s limb darkening, 2: Haard&#39;s limb brightening.</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(0.1, 20.0, 100))
invokemodel(energy, XS_KyrLine())</code></pre><pre><code class="nohighlight hljs">                        XS_KyrLine
        ┌────────────────────────────────────────┐
   0.05 │                                        │
        │                                        │
        │                                :       │
        │                                :.      │
        │                              :.&#39;:      │
        │                             :&#39;  :      │
        │                            :    :      │
        │                          .&#39;     :      │
        │                        .:&#39;      :      │
        │                       .&#39;        :      │
        │                     .:          :      │
        │                   .&#39;            :      │
        │                .:&#39;              :      │
        │            ..:&#39;                 :      │
      0 │.........:&#39;&#39;&#39;                    :......│
        └────────────────────────────────────────┘
         0                                      8
                          E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/fe119b4f9d7c74c9e57567f1f46f13f32a3db575/lib/XSPECModels/src/additive.jl#L267-L301">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../surrogate-models/">« Surrogate models</a><a class="docs-footer-nextpage" href="../../datasets/datasets/">Using datasets »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Sunday 10 August 2025 12:28">Sunday 10 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
