<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model index · SpectralFitting.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="SpectralFitting.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpectralFitting.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../why-and-how/">Why &amp; How</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../using-models/">Using models</a></li><li class="is-active"><a class="tocitem" href>Model index</a><ul class="internal"><li><a class="tocitem" href="#Julia-models"><span>Julia models</span></a></li><li><a class="tocitem" href="#XSPEC-models"><span>XSPEC models</span></a></li><li><a class="tocitem" href="#Generating-model-fingerprints"><span>Generating model fingerprints</span></a></li></ul></li><li><a class="tocitem" href="../composite-models/">Composite models</a></li><li><a class="tocitem" href="../surrogate-models/">Surrogate models</a></li></ul></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Models</a></li><li class="is-active"><a href>Model index</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model index</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/fjebaker/SpectralFitting.jl/blob/main/docs/src/models.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Models-index"><a class="docs-heading-anchor" href="#Models-index">Models index</a><a id="Models-index-1"></a><a class="docs-heading-anchor-permalink" href="#Models-index" title="Permalink"></a></h1><p>Models wrapped from XSPEC implementations are prefixed with <code>XS_*</code>, whereas pure-Julia models are simply named, e.g. <a href="#SpectralFitting.XS_PowerLaw"><code>XS_PowerLaw</code></a> in XSPEC vs <a href="#SpectralFitting.PowerLaw"><code>PowerLaw</code></a> in Julia.</p><p>The available models are</p><ul><li><a href="#SpectralFitting.BlackBody"><code>SpectralFitting.BlackBody</code></a></li><li><a href="#SpectralFitting.PowerLaw"><code>SpectralFitting.PowerLaw</code></a></li><li><a href="#SpectralFitting.XS_BlackBody"><code>SpectralFitting.XS_BlackBody</code></a></li><li><a href="#SpectralFitting.XS_BremsStrahlung"><code>SpectralFitting.XS_BremsStrahlung</code></a></li><li><a href="#SpectralFitting.XS_CalculateFlux"><code>SpectralFitting.XS_CalculateFlux</code></a></li><li><a href="#SpectralFitting.XS_DiskLine"><code>SpectralFitting.XS_DiskLine</code></a></li><li><a href="#SpectralFitting.XS_Gaussian"><code>SpectralFitting.XS_Gaussian</code></a></li><li><a href="#SpectralFitting.XS_KerrDisk"><code>SpectralFitting.XS_KerrDisk</code></a></li><li><a href="#SpectralFitting.XS_KyrLine"><code>SpectralFitting.XS_KyrLine</code></a></li><li><a href="#SpectralFitting.XS_Laor"><code>SpectralFitting.XS_Laor</code></a></li><li><a href="#SpectralFitting.XS_PhotoelectricAbsorption"><code>SpectralFitting.XS_PhotoelectricAbsorption</code></a></li><li><a href="#SpectralFitting.XS_PowerLaw"><code>SpectralFitting.XS_PowerLaw</code></a></li><li><a href="#SpectralFitting.XS_WarmAbsorption"><code>SpectralFitting.XS_WarmAbsorption</code></a></li></ul><h2 id="Julia-models"><a class="docs-heading-anchor" href="#Julia-models">Julia models</a><a id="Julia-models-1"></a><a class="docs-heading-anchor-permalink" href="#Julia-models" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SpectralFitting.PowerLaw" href="#SpectralFitting.PowerLaw"><code>SpectralFitting.PowerLaw</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">XS_PowerLaw(K, a)</code></pre><ul><li><p><code>K</code>: Normalisation.</p></li><li><p><code>a</code>: Photon index.</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(0.1, 20.0, 100))
invokemodel(energy, PowerLaw())</code></pre><pre><code class="nohighlight hljs">                        PowerLaw
       ┌────────────────────────────────────────┐
   0.5 │                                        │
       │:                                       │
       │:                                       │
       │:                                       │
       │:                                       │
       │:                                       │
       │:                                       │
       │ :                                      │
       │ :                                      │
       │  :                                     │
       │   :.                                   │
       │    &#39;:..                                │
       │        &#39;&#39;&#39;:......                      │
       │                  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;........│
     0 │                                        │
       └────────────────────────────────────────┘
        0                                     20
                         E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/509abbeffb0113a0e4206f69903cc8b0bc574523/src/julia-models/additive.jl#L1-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpectralFitting.BlackBody" href="#SpectralFitting.BlackBody"><code>SpectralFitting.BlackBody</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">XS_BlackBody(K, T)</code></pre><ul><li><p><code>K</code>: Normalisation.</p></li><li><p><code>kT</code>: Temperature (keV).</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(0.1, 20.0, 100))
invokemodel(energy, BlackBody())</code></pre><pre><code class="nohighlight hljs">                        BlackBody
       ┌────────────────────────────────────────┐
   0.2 │                                        │
       │                                        │
       │                                        │
       │                                        │
       │                                        │
       │                                        │
       │      .:&#39;&#39;&#39;:..                          │
       │     :&#39;      &#39;&#39;:.                       │
       │   .&#39;           &#39;:.                     │
       │  .:               &#39;..                  │
       │  :                  &#39;:.                │
       │ .&#39;                     &#39;:..            │
       │ :                         &#39;&#39;...        │
       │:                              &#39;&#39;&#39;....  │
     0 │:                                    &#39;&#39;&#39;│
       └────────────────────────────────────────┘
        0                                     20
                         E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/509abbeffb0113a0e4206f69903cc8b0bc574523/src/julia-models/additive.jl#L61-L95">source</a></section></article><h3 id="Defining-new-models"><a class="docs-heading-anchor" href="#Defining-new-models">Defining new models</a><a id="Defining-new-models-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-new-models" title="Permalink"></a></h3><p>To define a new Julia model, we need only implement the <a href="../using-models/#SpectralFitting.AbstractSpectralModel"><code>AbstractSpectralModel</code></a> interface. As a pedagogical example, consider an implementation of <a href="#SpectralFitting.PowerLaw"><code>PowerLaw</code></a>:</p><pre><code class="language-julia hljs"># define the model and parameters
@with_kw struct PowerLaw{F1,F2} &lt;: AbstractSpectralModel
    &quot;Normalisation.&quot;
    K::F1 = FitParam(1.0)
    &quot;Photon index.&quot;
    a::F2 = FitParam(0.5)
end

# tell the package what kind of model this is
modelkind(::Type{&lt;:PowerLaw}) = Additive()

# define how the model acts: 
# all of the parameters are passed, in order, as arguments
function SpectralFitting.invoke!(flux, energy, ::Type{&lt;:PowerLaw}, a)
    α = 1 - a
    α⁻¹ = inv(α)
    SpectralFitting.finite_diff_kernel!(flux, energy) do E
        α⁻¹ * E^α
    end
end</code></pre><p>Note that each parameter has its own parametric type, here <code>::F1</code> and <code>::F2</code>. This is so that the type of fit parameters can be changed, or alternative number types inserted (see <a href="../why-and-how/#Why-and-how">Why &amp; how</a>). The standard parameter type is <a href="@ref"><code>FitParam</code></a>, which is what we have used here.</p><p>The model is defined to be additive by overloading <a href="../using-models/#SpectralFitting.modelkind"><code>modelkind</code></a>.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>Additive models <em>must have</em> a normalisation parameter with the symbol <code>K</code>, which is, however, <em>not passed</em> to <a href="../using-models/#SpectralFitting.invoke!"><code>SpectralFitting.invoke!</code></a>. Multiplicative and convolutional models have no such requirements.</p></div></div><p>We have also used the <a href="../reference/#SpectralFitting.finite_diff_kernel!"><code>SpectralFitting.finite_diff_kernel!</code></a> utility function, which is designed to help us efficiently compute finite-difference integrations of flux, just as XSPEC does.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>To add additional XSPEC models, see <a href="#Wrapping-new-XSPEC-models">Wrapping new XSPEC models</a>.</p></div></div><h2 id="XSPEC-models"><a class="docs-heading-anchor" href="#XSPEC-models">XSPEC models</a><a id="XSPEC-models-1"></a><a class="docs-heading-anchor-permalink" href="#XSPEC-models" title="Permalink"></a></h2><p>XSPEC models frequently have tabular data dependencies, without which the models fail to invoke (see <a href="../using-models/#Model-data-availability">Model data availability</a>). If the data files are known but not present, the XSPEC models will throw an error with instructions for downloading the missing data. If the data files are unknown, Julia may crash catastrophically. If this is the case, often a single line will be printed with the LibXSPEC error, specifying the name of the missing source file. This can be registered as a data dependency of a model using <a href="#SpectralFitting.register_model_data"><code>SpectralFitting.register_model_data</code></a>.</p><p>The first time any XSPEC model is invoked, SpectralFitting checks to see whether requisite data is needed, and whether the data is downloaded. Subsequent calls will hit a lookup cache instead to avoid run-time costs of performing this check.</p><article class="docstring"><header><a class="docstring-binding" id="SpectralFitting.XS_PowerLaw" href="#SpectralFitting.XS_PowerLaw"><code>SpectralFitting.XS_PowerLaw</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">XS_PowerLaw(K, a)</code></pre><ul><li><p><code>K</code>: Normalisation.</p></li><li><p><code>a</code>: Photon index.</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(0.1, 20.0, 100))
invokemodel(energy, XS_PowerLaw())</code></pre><pre><code class="nohighlight hljs">                      XS_PowerLaw
       ┌────────────────────────────────────────┐
   0.5 │                                        │
       │:                                       │
       │:                                       │
       │:                                       │
       │:                                       │
       │:                                       │
       │:                                       │
       │ :                                      │
       │ :                                      │
       │  :                                     │
       │   :.                                   │
       │    &#39;:..                                │
       │        &#39;&#39;&#39;:......                      │
       │                  &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;........│
     0 │                                        │
       └────────────────────────────────────────┘
        0                                     20
                         E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/509abbeffb0113a0e4206f69903cc8b0bc574523/src/xspec-models/additive.jl#L1-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpectralFitting.XS_BlackBody" href="#SpectralFitting.XS_BlackBody"><code>SpectralFitting.XS_BlackBody</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">XS_BlackBody(K, T)</code></pre><ul><li><p><code>K</code>: Normalisation.</p></li><li><p><code>T</code>: Temperature (keV).</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(0.1, 20.0, 100))
invokemodel(energy, XS_BlackBody())</code></pre><pre><code class="nohighlight hljs">                      XS_BlackBody
       ┌────────────────────────────────────────┐
   0.2 │                                        │
       │                                        │
       │                                        │
       │                                        │
       │                                        │
       │                                        │
       │      .:&#39;&#39;&#39;:..                          │
       │    .:       &#39;&#39;.                        │
       │   .&#39;           &#39;:.                     │
       │   :              &#39;&#39;..                  │
       │  :                  &#39;:.                │
       │ :                     &#39;&#39;:.             │
       │.:                         &#39;&#39;..         │
       │:                              &#39;&#39;:....  │
     0 │&#39;                                    &#39;&#39;&#39;│
       └────────────────────────────────────────┘
        0                                     20
                         E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/509abbeffb0113a0e4206f69903cc8b0bc574523/src/xspec-models/additive.jl#L46-L80">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpectralFitting.XS_BremsStrahlung" href="#SpectralFitting.XS_BremsStrahlung"><code>SpectralFitting.XS_BremsStrahlung</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">XS_BremsStrahlung(K, T)</code></pre><ul><li><p><code>K</code>: Normalisation.</p></li><li><p><code>T</code>: Plasma temperature (keV).</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(0.1, 20.0, 100))
invokemodel(energy, XS_BremsStrahlung())</code></pre><pre><code class="nohighlight hljs">                  XS_BremsStrahlung
     ┌────────────────────────────────────────┐
   2 │                                        │
     │.                                       │
     │:                                       │
     │:                                       │
     │:                                       │
     │:                                       │
     │:                                       │
     │:                                       │
     │:                                       │
     │:                                       │
     │:                                       │
     │:                                       │
     │&#39;.                                      │
     │ :                                      │
   0 │  &#39;:....................................│
     └────────────────────────────────────────┘
      0                                     20
                       E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/509abbeffb0113a0e4206f69903cc8b0bc574523/src/xspec-models/additive.jl#L91-L125">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpectralFitting.XS_Gaussian" href="#SpectralFitting.XS_Gaussian"><code>SpectralFitting.XS_Gaussian</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">XS_Gaussian(K, E, σ)</code></pre><ul><li><p><code>K</code>: Normalisation</p></li><li><p><code>E</code>: Line wavelength in Angstrom.</p></li><li><p><code>σ</code>: Line width in Angstrom.</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(4.0, 8.0, 100))
invokemodel(energy, XS_Gaussian())</code></pre><pre><code class="nohighlight hljs">                        XS_Gaussian                
        ┌────────────────────────────────────────┐ 
   0.09 │                                        │ 
        │            .                           │ 
        │           : :                          │ 
        │           : :                          │ 
        │           : &#39;.                         │ 
        │          .&#39;  :                         │ 
        │          :   :                         │ 
        │          :   :                         │ 
        │          :   &#39;.                        │ 
        │         :     :                        │ 
        │         :     :                        │ 
        │         :     :                        │ 
        │        .&#39;      :                       │ 
        │        :       :                       │ 
      0 │.......:         :......................│ 
        └────────────────────────────────────────┘ 
         0                                     20  
                          E (keV)                  </code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/509abbeffb0113a0e4206f69903cc8b0bc574523/src/xspec-models/additive.jl#L434-L468">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpectralFitting.XS_Laor" href="#SpectralFitting.XS_Laor"><code>SpectralFitting.XS_Laor</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">XS_Laor(K, lineE, a, inner_r, outer_r, incl)</code></pre><ul><li><p><code>K</code>: Normalisation.</p></li><li><p><code>lineE</code>: Rest frame line energy (keV).</p></li><li><p><code>a</code>: Power law dependence of emissitivy. Scales R⁻ᵅ.</p></li><li><p><code>inner_r</code>: Inner radius of the accretion disk (GM/c).</p></li><li><p><code>outer_r</code>: Outer radius of the accretion disk (GM/c).</p></li><li><p><code>θ</code>: Disk inclination angle to line of sight (degrees, 0 is pole on).</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(0.1, 10.0, 100))
invokemodel(energy, XS_Laor())</code></pre><pre><code class="nohighlight hljs">                          XS_Laor
        ┌────────────────────────────────────────┐
   0.06 │                                        │
        │                                        │
        │                         ::             │
        │                         ::             │
        │                        : :             │
        │                       :  :             │
        │                      :   :             │
        │                     :&#39;   :             │
        │                   .:     :             │
        │                  :&#39;      :             │
        │                .&#39;        :             │
        │              .:&#39;         :             │
        │            ..&#39;           :             │
        │          .:&#39;              :            │
      0 │.......:&#39;&#39;                 :............│
        └────────────────────────────────────────┘
         0                                     10
                          E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/509abbeffb0113a0e4206f69903cc8b0bc574523/src/xspec-models/additive.jl#L313-L347">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpectralFitting.XS_DiskLine" href="#SpectralFitting.XS_DiskLine"><code>SpectralFitting.XS_DiskLine</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">XS_DiskLine(K, lineE, β, inner_r, outer_r, incl)</code></pre><ul><li><p><code>K</code>: Normalisation.</p></li><li><p><code>lineE</code>: Rest frame line energy (keV).</p></li><li><p><code>β</code>: Power law dependence of emissitivy. If &lt; 10, scales Rᵅ.</p></li><li><p><code>inner_r</code>: Inner radius of the accretion disk (GM/c).</p></li><li><p><code>outer_r</code>: Outer radius of the accretion disk (GM/c).</p></li><li><p><code>θ</code>: Disk inclination angle to line of sight (degrees, 0 is pole on).</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(4.0, 8.0, 100))
invokemodel(energy, XS_DiskLine())</code></pre><pre><code class="nohighlight hljs">                        XS_DiskLine
        ┌────────────────────────────────────────┐
   0.09 │                                        │
        │                           .            │
        │                           :            │
        │                           ::           │
        │                         . ::           │
        │                         : ::           │
        │                         :&#39;&#39;:           │
        │                        .&#39;  :           │
        │                        :    :          │
        │                        :    :          │
        │                       .&#39;    :          │
        │                       :     :          │
        │                     .:      &#39;.         │
        │                   .:&#39;        :         │
      0 │...............:&#39;&#39;&#39;           :.........│
        └────────────────────────────────────────┘
         4                                      8
                          E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/509abbeffb0113a0e4206f69903cc8b0bc574523/src/xspec-models/additive.jl#L374-L408">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpectralFitting.XS_PhotoelectricAbsorption" href="#SpectralFitting.XS_PhotoelectricAbsorption"><code>SpectralFitting.XS_PhotoelectricAbsorption</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">XS_PhotoelectricAbsorption(ηH)</code></pre><ul><li><code>ηH</code>: Equivalent hydrogen column (units of 10²² atoms per cm⁻²).</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(0.1, 20.0, 100))
invokemodel(energy, XS_PhotoelectricAbsorption())</code></pre><pre><code class="nohighlight hljs">             XS_PhotoelectricAbsorption
     ┌────────────────────────────────────────┐
   1 │       ...&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;│
     │      .&#39;                                │
     │     :                                  │
     │    :&#39;                                  │
     │    :                                   │
     │   :                                    │
     │   :                                    │
     │   :                                    │
     │  :                                     │
     │  :                                     │
     │  :                                     │
     │  :                                     │
     │  :                                     │
     │ :                                      │
   0 │.:                                      │
     └────────────────────────────────────────┘
      0                                     20
                       E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/509abbeffb0113a0e4206f69903cc8b0bc574523/src/xspec-models/multiplicative.jl#L1-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpectralFitting.XS_WarmAbsorption" href="#SpectralFitting.XS_WarmAbsorption"><code>SpectralFitting.XS_WarmAbsorption</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">XS_WarmAbsorption(ηH, Ew)</code></pre><ul><li><p><code>ηH</code>: Equivalent hydrogen column (units of 10²² atoms per cm⁻²).</p></li><li><p><code>Ew</code>: Window energy (keV).</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(0.1, 20.0, 100))
invokemodel(energy, XS_WarmAbsorption())</code></pre><pre><code class="nohighlight hljs">                    XS_WarmAbsorption
       ┌────────────────────────────────────────┐
     1 │&#39;:      ...&#39;&#39;&#39;:&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;│
       │ :    .:&#39;                               │
       │ :   .&#39;                                 │
       │ :  .:                                  │
       │ :  :                                   │
       │ :  :                                   │
       │ : :                                    │
       │ : :                                    │
       │ : :                                    │
       │ : :                                    │
       │ ::                                     │
       │ ::                                     │
       │  :                                     │
       │  :                                     │
   0.2 │  :                                     │
       └────────────────────────────────────────┘
        0                                     20
                         E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/509abbeffb0113a0e4206f69903cc8b0bc574523/src/xspec-models/multiplicative.jl#L45-L79">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpectralFitting.XS_CalculateFlux" href="#SpectralFitting.XS_CalculateFlux"><code>SpectralFitting.XS_CalculateFlux</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">XS_CalculateFlux(E_min, E_max, lg10Flux)</code></pre><ul><li><p><code>E_min</code>: Minimum energy.</p></li><li><p><code>E_max</code>: Maximum energy.</p></li><li><p><code>log10Flux</code>: log (base 10) flux in erg / cm^2 / s</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/509abbeffb0113a0e4206f69903cc8b0bc574523/src/xspec-models/convolutional.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpectralFitting.XS_KerrDisk" href="#SpectralFitting.XS_KerrDisk"><code>SpectralFitting.XS_KerrDisk</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">XS_KerrDisk(K, lineE, index1, index2, break_r, a, θ, inner_r, outer_r)</code></pre><ul><li><p><code>K</code>: Normalisation.</p></li><li><p><code>lineE</code>: Rest frame line energy (keV).</p></li><li><p><code>index1</code>: Emissivity index for inner disk.</p></li><li><p><code>index2</code>: Emissivity index for outer disk.</p></li><li><p><code>break_r</code>: Break radius seperating inner and outer disk (gᵣ).</p></li><li><p><code>a</code>: Dimensionless black hole spin.</p></li><li><p><code>θ</code>: Disk inclination angle to line of sight (degrees).</p></li><li><p><code>inner_r</code>: Inner radius of the disk in units of rₘₛ.</p></li><li><p><code>outer_r</code>: Outer radius of the disk in units of rₘₛ.</p></li><li><p><code>z</code>: Redshift.</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(0.1, 20.0, 100))
invokemodel(energy, XS_KerrDisk())</code></pre><pre><code class="nohighlight hljs">                        XS_KerrDisk
        ┌────────────────────────────────────────┐
   0.05 │                                        │
        │                                        │
        │                                .       │
        │                               .:       │
        │                              :::       │
        │                            .:&#39; &#39;.      │
        │                           .:    :      │
        │                         ..&#39;     :      │
        │                         :&#39;      :      │
        │                       .&#39;        :      │
        │                     .:&#39;         :      │
        │                  .:&#39;&#39;           :      │
        │               .::&#39;              :      │
        │            ..:&#39;                 :      │
      0 │.........:&#39;&#39;&#39;                    :......│
        └────────────────────────────────────────┘
         0                                      8
                          E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/509abbeffb0113a0e4206f69903cc8b0bc574523/src/xspec-models/additive.jl#L137-L171">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpectralFitting.XS_KyrLine" href="#SpectralFitting.XS_KyrLine"><code>SpectralFitting.XS_KyrLine</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">XS_KyrLine(K, a, θ_obs, inner_r, ms_flag, outer_r, lineE, α, β, break_r, z, limb)</code></pre><ul><li><p><code>K</code>: Normalisation.</p></li><li><p><code>a</code>: Dimensionless black hole spin.</p></li><li><p><code>θ</code>: Observer inclination (0 is on pole, degrees).</p></li><li><p><code>inner_r</code>: Inner radius of the disk in units of GM/c²</p></li><li><p><code>ms_flag</code>: 0: integrate from rᵢₙ. 1: integrate from rₘₛ.</p></li><li><p><code>outer_r</code>: Outer radius of the disk in units of GM/c²</p></li><li><p><code>lineE</code>: Rest frame line energy (keV).</p></li><li><p><code>α</code></p></li><li><p><code>β</code></p></li><li><p><code>break_r</code>: Break radius seperating inner and outer disk (GM/c²).</p></li><li><p><code>z</code>: Overall Doppler shift.</p></li><li><p><code>limb</code>: 0: isotropic emission, 1: Laor&#39;s limb darkening, 2: Haard&#39;s limb brightening.</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">energy = collect(range(0.1, 20.0, 100))
invokemodel(energy, XS_KyrLine())</code></pre><pre><code class="nohighlight hljs">                        XS_KyrLine
        ┌────────────────────────────────────────┐
   0.05 │                                        │
        │                                        │
        │                                :       │
        │                                :.      │
        │                              :.&#39;:      │
        │                             :&#39;  :      │
        │                            :    :      │
        │                          .&#39;     :      │
        │                        .:&#39;      :      │
        │                       .&#39;        :      │
        │                     .:          :      │
        │                   .&#39;            :      │
        │                .:&#39;              :      │
        │            ..:&#39;                 :      │
      0 │.........:&#39;&#39;&#39;                    :......│
        └────────────────────────────────────────┘
         0                                      8
                          E (keV)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/509abbeffb0113a0e4206f69903cc8b0bc574523/src/xspec-models/additive.jl#L222-L256">source</a></section></article><h3 id="Wrapping-new-XSPEC-models"><a class="docs-heading-anchor" href="#Wrapping-new-XSPEC-models">Wrapping new XSPEC models</a><a id="Wrapping-new-XSPEC-models-1"></a><a class="docs-heading-anchor-permalink" href="#Wrapping-new-XSPEC-models" title="Permalink"></a></h3><p>SpectralFitting exports a helpful macro to facilitate wrapping additional XSPEC models.</p><article class="docstring"><header><a class="docstring-binding" id="SpectralFitting.@xspecmodel" href="#SpectralFitting.@xspecmodel"><code>SpectralFitting.@xspecmodel</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@xspecmodel model_kind func_name model</code></pre><p>Used to wrap additional XSPEC models, generating the needed <a href="../using-models/#SpectralFitting.AbstractSpectralModel"><code>AbstractSpectralModel</code></a> implementation.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">@xspecmodel Additive :C_powerlaw struct XS_PowerLaw{F1,F2}
    &quot;Normalisation.&quot;
    K::F1 = FitParam(1.0)
    &quot;Photon index.&quot;
    a::F2 = FitParam(0.5)
end</code></pre><p>We define a new structure <code>XS_PowerLaw</code> with two parameters, but since the model is <a href="../using-models/#SpectralFitting.Additive"><code>Additive</code></a>, only a single parameter (<code>a</code>) is passed to the XSPEC function. The function we bind to this model is <code>:C_powerlaw</code> from the XSPEC C wrappers.</p><p>The macro will then generate the following functions</p><pre><code class="language-julia hljs">modelkind(::Type{&lt;:XS_PowerLaw})
implementation(::Type{&lt;:XS_PowerLaw})
invoke!(::Type{&lt;:XS_PowerLaw})</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/509abbeffb0113a0e4206f69903cc8b0bc574523/src/ccall-wrapper.jl#L65-L92">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpectralFitting.register_model_data" href="#SpectralFitting.register_model_data"><code>SpectralFitting.register_model_data</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">SpectralFitting.register_model_data(M::Type{&lt;:AbstractSpectralModel}, filenames::String...)
SpectralFitting.register_model_data(s::Symbol, filenames::String...)</code></pre><p>Register <code>filenames</code> as model data associated with the model given by type <code>M</code> or symbol <code>s</code>. This function does not download any files, but rather adds the relevant filenames to a lookup which <a href="../using-models/#SpectralFitting.download_model_data"><code>SpectralFitting.download_model_data</code></a> consults when invoked, and consequently model data is only downloaded when needed.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>It is good practice to use this method immediately after defining a new model with <a href="#SpectralFitting.@xspecmodel"><code>@xspecmodel</code></a> to register any required datafiles from the HEASoft source code, and therefore keep relevant information together.</p></div></div><p><strong>Example</strong></p><pre><code class="language-julia hljs"># by type
register_model_data(XS_Laor, &quot;ari.mod&quot;)
# by symbol
register_model_data(:XS_KyrLine, &quot;KBHline01.fits&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fjebaker/SpectralFitting.jl/blob/509abbeffb0113a0e4206f69903cc8b0bc574523/src/model-data-io.jl#L17-L37">source</a></section></article><h2 id="Generating-model-fingerprints"><a class="docs-heading-anchor" href="#Generating-model-fingerprints">Generating model fingerprints</a><a id="Generating-model-fingerprints-1"></a><a class="docs-heading-anchor-permalink" href="#Generating-model-fingerprints" title="Permalink"></a></h2><p>To generate the unicode plot to add as a fingerprint, we use a simple function:</p><pre><code class="language- hljs">using UnicodePlots

function plotmodel(energy, model)
    flux = invokemodel(energy, model)
    lineplot(
        energy[1:end-1], 
        flux, 
        title=String(SpectralFitting.model_base_name(typeof(model))), 
        xlabel=&quot;E (keV)&quot;, 
        canvas=DotCanvas
    )
end

# e.g. for XS_PowerLaw()
energy = collect(range(0.1, 20.0, 100))
plotmodel(energy, XS_PowerLaw())</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../using-models/">« Using models</a><a class="docs-footer-nextpage" href="../composite-models/">Composite models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Wednesday 13 September 2023 12:32">Wednesday 13 September 2023</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
